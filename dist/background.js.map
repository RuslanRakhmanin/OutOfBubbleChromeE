{"version":3,"file":"background.js","mappings":"wGAiCA,wBAA6BA,EAAe,IAErCC,OAAOC,OAAOC,aAAa,CAAEH,KAAMA,GAC1C,EAEA,wBAA6BI,EAAmB,IAC7B,KAAbA,IACFA,EAAW,eAEbH,OAAOC,OAAOG,QAAQ,CACpBC,KAAM,CACJ,IAAKF,IAGX,EA/Ca,EAAAG,QAAU,C,+DCiEvB,yBACE,OAAOC,CACT,EAEA,wBAA6BC,GAC3B,OAAOD,EAASE,MAAMC,GAAYA,EAAQF,MAAQA,GACpD,EArEA,IAAID,EAAgC,CAClC,CACEC,IAAK,yIACLG,MACE,kFACFC,KAAM,EACNC,QAAS,CACP,CAAEC,WAAY,iBAAkBN,IAAK,wDAAyDI,KAAM,GACpG,CAAEE,WAAY,iBAAkBN,IAAK,yIAA0II,KAAM,GACrL,CAAEE,WAAY,cAAeN,IAAK,kIAAmII,KAAM,IAE7KG,qBAAsB,CACpB,4BACA,sBACA,+BAEFC,OAAQ,CACN,wDACA,0CACA,uCACA,+BACA,yCAGJ,CACER,IAAK,wDACLG,MAAO,qEACPC,KAAM,EACNC,QAAS,CACP,CAAEC,WAAY,iBAAkBN,IAAK,wDAAyDI,KAAM,GACpG,CAAEE,WAAY,iBAAkBN,IAAK,yIAA0II,KAAM,GACrL,CAAEE,WAAY,cAAeN,IAAK,kIAAmII,KAAM,IAE7KG,qBAAsB,CAAC,aACvBC,OAAQ,CACN,0FACA,8FACA,6GACA,sEACA,mGAGJ,CACER,IAAK,kIACLG,MACE,kFACFC,KAAM,EACNC,QAAS,CACP,CAAEC,WAAY,iBAAkBN,IAAK,wDAAyDI,KAAM,GACpG,CAAEE,WAAY,iBAAkBN,IAAK,yIAA0II,KAAM,GACrL,CAAEE,WAAY,cAAeN,IAAK,kIAAmII,KAAM,IAE7KG,qBAAsB,CAAC,mBAAoB,UAAW,uBACtDC,OAAQ,CACN,yCACA,iEACA,sDACA,iDACA,+C,GC3DFC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,OACf,C,MCtBA,eAOA,SAEA,IAEIG,EAFAC,EAAqD,CAAC,EAI1D,SAASC,IACP3B,OAAO4B,QAAQC,KAAKC,IAAI,WAAYC,KAClC,IAAA7B,cAAa,GAAG,KAElB,IAAA8B,eACF,CAUA,SAASC,EAAqBzB,EAAc,eAE1C,GADA0B,QAAQC,IAAI,uBAAwB3B,GACxB,gBAARA,EAUF,OAAOiB,EAGT,QAA0BJ,IAAtBK,EAAalB,GAAoB,CACnC,IAAIuB,GAAsC,IAAAK,cAAa5B,GACvD,QAAaa,IAATU,EACF,OAEAL,EAAalB,GAAOuB,CAExB,CACA,OAAOL,EAAalB,EACtB,CAEA,SAAS6B,EAAY7B,GACnB,YAAYa,IAARb,EACK,eAETiB,EAAwBQ,EAAqBzB,QACfa,IAA1BI,EACK,cAELA,EAAsBb,KAAO,EACxB,sBAE0B,IAA/Ba,EAAsBb,KACjB,sBAELa,EAAsBb,KAAO,EACxB,2BADT,EAGF,CAGA,SAAS0B,EAAWC,GAClB,GAAkC,UAtDjBlB,KADImB,EAuDHD,SArDFlB,IAAXmB,EAAIC,SACQpB,IAAZmB,EAAIhC,KACQ,KAAZgC,EAAIhC,KACJgC,EAAIhC,IAAIkC,WAAW,cAoDtB,YADA,IAAAV,gBAxDJ,IAAuBQ,EA6DrB,IAAIrC,EAAWkC,EAAYE,EAAW/B,UACrBa,IAAblB,IACF,IAAA6B,cAAa7B,EAEjB,CAGAH,OAAO2C,QAAQC,UAAUC,YAAYlB,GACrC3B,OAAO2C,QAAQG,YAAYD,YAAYlB,GAEvC3B,OAAO2C,QAAQI,UAAUF,aAAY,CAACG,EAASC,EAAQC,KACrD,MAAMC,EAAUH,EAUhB,QAAqB3B,IAAjB8B,EAAQC,KACV,OAAQD,EAAQC,MACd,IAAK,qBACHF,EAAajB,EAAqBkB,EAAQpB,OAC1C,MACF,IAAK,0BACHmB,EAAajB,KACb,MACF,IAAK,mBACHiB,EAAab,EAAYc,EAAQpB,OACjC,MACF,QACEG,QAAQmB,KAAK,uBAAwBF,EAAQC,MAC7CF,OAAa7B,QAIjBa,QAAQmB,KAAK,kBAAmBF,GAChCD,OAAa7B,EACf,IAKFrB,OAAOsD,KAAKC,YAAYV,aAAaW,IAEnCxD,OAAOsD,KAAKG,MAAM,CAAEC,QAAQ,EAAMC,eAAe,IAASL,IACxD,MAAMf,EAAae,EAAK,GACxBpB,QAAQC,IAAI,mBAAoBI,GAChCD,EAAWC,EAAW,GACtB,IAGJvC,OAAOsD,KAAKM,UAAUf,aAAY,CAACgB,EAAOC,EAAYtB,KACpDF,EAAWE,EAAI,G","sources":["webpack://out-of-bubble/./src/common.ts","webpack://out-of-bubble/./src/demodata.ts","webpack://out-of-bubble/webpack/bootstrap","webpack://out-of-bubble/./src/background.ts"],"sourcesContent":["export const maxRank = 5\n\nexport interface Message {\n  enabled?: boolean\n  type?: string\n  data?: any\n}\n\nexport interface ArticleProperties {\n  url: string,\n  title: string,\n  rank: number,\n  sources: { sourceName: string, url: string, rank: number}[],\n  psychologicalTactics: string[],\n  sumUp5: string[]\n}\n\nexport interface StoredConfig {\n  enabled?: boolean\n  showOtherSources?: boolean\n  showPsychologicalTactics?: boolean\n  showSummary?: boolean\n  customIcons?: { [key: string]: string }\n  articles?: ArticleProperties[]\n  excludeHosts?: string[]\n  whiteList?: string[]\n}\n\nexport interface TabResponse {\n  title: string\n  url: string\n}\n\nexport function setBadgeText(text: string = \"\") {\n  // const text = enabled ? \"ON\" : \"OFF\"\n  void chrome.action.setBadgeText({ text: text })\n}\n\nexport function setBadgeIcon(iconName: string = \"\") {\n  if (iconName === \"\") {\n    iconName = \"icon128.png\"\n  }\n  chrome.action.setIcon({\n    path: {\n      128: iconName\n    }\n  });\n}","import { ArticleProperties } from \"./common\"\r\n\r\nlet demoData: ArticleProperties[] = [\r\n  {\r\n    url: \"https://www.independent.ie/irish-news/crime/irish-man-50-shot-dead-in-malta-after-ex-partners-body-found-in-apartment/a1366613683.html\",\r\n    title:\r\n      \"Irishman shot dead in Maltese police after ex-partnerâ€™s body found in apartment\",\r\n    rank: 4,\r\n    sources: [\r\n      { sourceName: \"Irish Examiner\", url: \"https://www.irishexaminer.com/news/arid-41454697.html\", rank: 3},\r\n      { sourceName: \"Independent.ie\", url: \"https://www.independent.ie/irish-news/crime/irish-man-50-shot-dead-in-malta-after-ex-partners-body-found-in-apartment/a1366613683.html\", rank: 4},\r\n      { sourceName: \"Irish Times\", url: \"https://www.irishtimes.com/crime-law/2024/08/12/irishman-shot-dead-by-police-in-malta-after-allegedly-murdering-former-partner/\", rank: 2}\r\n      ],     \r\n    psychologicalTactics: [\r\n      \"Use of emotional language\",\r\n      \"Focus on the victim\",\r\n      \"Omission of certain details\",\r\n    ],\r\n    sumUp5: [\r\n      \"Irish man shot dead by Maltese police after standoff.\",\r\n      \"Ex-partner found murdered in apartment.\",\r\n      \"Man suspected of killing ex-partner.\",\r\n      \"Standoff lasted three hours.\",\r\n      \"Police Commissioner outlines events.\",\r\n    ],\r\n  },\r\n  {\r\n    url: \"https://www.irishexaminer.com/news/arid-41454697.html\",\r\n    title: \"Irishman killed by police in Malta after allegedly murdering woman\",\r\n    rank: 3,\r\n    sources: [\r\n      { sourceName: \"Irish Examiner\", url: \"https://www.irishexaminer.com/news/arid-41454697.html\", rank: 3},\r\n      { sourceName: \"Independent.ie\", url: \"https://www.independent.ie/irish-news/crime/irish-man-50-shot-dead-in-malta-after-ex-partners-body-found-in-apartment/a1366613683.html\", rank: 4},\r\n      { sourceName: \"Irish Times\", url: \"https://www.irishtimes.com/crime-law/2024/08/12/irishman-shot-dead-by-police-in-malta-after-allegedly-murdering-former-partner/\", rank: 2}\r\n      ],     \r\n    psychologicalTactics: [\"Not found\"],\r\n    sumUp5: [\r\n      \"Irish man, Edward Johnston, allegedly murders his ex-partner Nicolette Ghirxi in Malta.\",\r\n      \"Johnston holds staff at a Hilton Hotel hostage with a replica gun, confesses to the murder.\",\r\n      \"Police engage in a standoff with Johnston, who eventually points the replica gun at them and is shot dead.\",\r\n      \"Ghirxi had filed harassment complaints against Johnston previously.\",\r\n      \"The incident has sparked outrage and calls for action against violence against women in Malta.\",\r\n    ],\r\n  },\r\n  {\r\n    url: \"https://www.irishtimes.com/crime-law/2024/08/12/irishman-shot-dead-by-police-in-malta-after-allegedly-murdering-former-partner/\",\r\n    title:\r\n      \"Irish man shot dead by police in Malta after allegedly murdering former partner\",\r\n    rank: 2,\r\n    sources: [\r\n      { sourceName: \"Irish Examiner\", url: \"https://www.irishexaminer.com/news/arid-41454697.html\", rank: 3},\r\n      { sourceName: \"Independent.ie\", url: \"https://www.independent.ie/irish-news/crime/irish-man-50-shot-dead-in-malta-after-ex-partners-body-found-in-apartment/a1366613683.html\", rank: 4},\r\n      { sourceName: \"Irish Times\", url: \"https://www.irishtimes.com/crime-law/2024/08/12/irishman-shot-dead-by-police-in-malta-after-allegedly-murdering-former-partner/\", rank: 2}\r\n      ],    \r\n    psychologicalTactics: [\"Emotional Appeal\", \"Framing\", \"Omission of Context\"],\r\n    sumUp5: [\r\n      \"Irish man shot dead by Maltese police.\",\r\n      \"Man allegedly murdered his former partner before the shooting.\",\r\n      \"Police negotiated with the man before shooting him.\",\r\n      \"Woman's body found with multiple knife wounds.\",\r\n      \"Man had a history of harassing the victim.\",\r\n    ],\r\n  },\r\n]\r\n\r\nexport function getDemoData() {\r\n  return demoData\r\n}\r\n\r\nexport function getDataByURL(url: string) {\r\n  return demoData.find((article) => article.url === url)\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import {\n  Message,\n  setBadgeText,\n  setBadgeIcon,\n  StoredConfig,\n  ArticleProperties,\n} from \"./common\"\nimport { getDemoData, getDataByURL } from \"./demodata\"\n\nlet articlesData: { [key: string]: ArticleProperties } = {}\n\nlet currentPageProperties: ArticleProperties | undefined\n\nfunction startUp() {\n  chrome.storage.sync.get(\"enabled\", (data) => {\n    setBadgeText(\"\")\n  })\n  setBadgeIcon()\n}\n\nfunction checkTabReady(tab: chrome.tabs.Tab) {\n  return !(tab === undefined\n    || tab.id === undefined \n    || tab.url === undefined \n    || tab.url === \"\" \n    || tab.url.startsWith(\"chrome://\"))\n}\n\nfunction getArticleProperties(url: string = \"Current tab\") {\n  console.log(\"getArticleProperties\", url)\n  if (url === \"Current tab\") {\n    //// Does not work on clicking the extension icon\n    // chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n    //   const currentTab = tabs[0] as chrome.tabs.Tab\n    //   if (checkTabReady(currentTab) === false) {\n    //     return undefined\n    //   }\n    //   url = currentTab.url as string\n    // })\n\n    return currentPageProperties\n  }\n\n  if (articlesData[url] === undefined) {\n    let data: ArticleProperties | undefined = getDataByURL(url)\n    if (data === undefined) {\n      return undefined\n    } else {\n      articlesData[url] = data as ArticleProperties\n    }\n  }\n  return articlesData[url]\n}\n\nfunction getIconName(url?: string) {\n  if (url === undefined) {\n    return \"icon128.png\"\n  }\n  currentPageProperties = getArticleProperties(url)\n  if (currentPageProperties === undefined) {\n    return \"icon128.png\"\n  }\n  if (currentPageProperties.rank < 3) {\n    return \"icon_set1_1_128.png\"\n  }\n  if (currentPageProperties.rank === 3) {\n    return \"icon_set1_2_128.png\"\n  }\n  if (currentPageProperties.rank > 3) {\n    return \"icon_set1_3_128.png\"\n  }\n}\n\n\nfunction updateInfo(currentTab: chrome.tabs.Tab) {\n  if (checkTabReady(currentTab) === false) {\n    setBadgeIcon()\n    return\n  }\n\n\n  let iconName = getIconName(currentTab.url)\n  if (iconName !== undefined) {\n    setBadgeIcon(iconName)\n  }\n}\n\n// Ensure the background script always runs.\nchrome.runtime.onStartup.addListener(startUp)\nchrome.runtime.onInstalled.addListener(startUp)\n\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\n  const message = request as Message\n  // if (message.enabled !== undefined) {\n  //   console.log(\n  //     \"Service worker received message from sender %s\",\n  //     sender.id,\n  //     request,\n  //   )\n  //   // sendResponse({ message: \"Service worker processed the message\" })\n  // }\n\n  if (message.type !== undefined) {\n    switch (message.type) {\n      case \"getPropertiesByURL\":\n        sendResponse(getArticleProperties(message.data))\n        break\n      case \"getPropertiesCurrentTab\":\n        sendResponse(getArticleProperties())\n        break\n      case \"getIconNameByURL\":\n        sendResponse(getIconName(message.data))\n        break\n      default:\n        console.warn(\"Unknown message type\", message.type)\n        sendResponse(undefined)\n        break\n    }\n  } else {\n    console.warn(\"Unknown message\", message)\n    sendResponse(undefined)\n  }\n})\n\n\n// console.log(\"Add listener on Activated\")\nchrome.tabs.onActivated.addListener((activeInfo) => {\n  // console.log(\"Got focus on tab\")\n  chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n    const currentTab = tabs[0] as chrome.tabs.Tab\n    console.log(\"Got focus on tab\", currentTab)\n    updateInfo(currentTab)\n  })\n})\n\nchrome.tabs.onUpdated.addListener((tabId, changeInfo, tab)  =>{\n  updateInfo(tab)\n});"],"names":["text","chrome","action","setBadgeText","iconName","setIcon","path","maxRank","demoData","url","find","article","title","rank","sources","sourceName","psychologicalTactics","sumUp5","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","currentPageProperties","articlesData","startUp","storage","sync","get","data","setBadgeIcon","getArticleProperties","console","log","getDataByURL","getIconName","updateInfo","currentTab","tab","id","startsWith","runtime","onStartup","addListener","onInstalled","onMessage","request","sender","sendResponse","message","type","warn","tabs","onActivated","activeInfo","query","active","currentWindow","onUpdated","tabId","changeInfo"],"sourceRoot":""}